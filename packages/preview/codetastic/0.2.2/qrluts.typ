
// Keys are "version-ecl"
// Modes are 0:Numerical, 1:Alphanumerical, 2:Byte, 3:Kanji
#let capacities = (
  "1-l": (41, 25, 17, 10),
  "1-m": (34, 20, 14, 8),
  "1-q": (27, 16, 11, 7),
  "1-h": (17, 10, 7, 4),
  "2-l": (77, 47, 32, 20),
  "2-m": (63, 38, 26, 16),
  "2-q": (48, 29, 20, 12),
  "2-h": (34, 20, 14, 8),
  "3-l": (127, 77, 53, 32),
  "3-m": (101, 61, 42, 26),
  "3-q": (77, 47, 32, 20),
  "3-h": (58, 35, 24, 15),
  "4-l": (187, 114, 78, 48),
  "4-m": (149, 90, 62, 38),
  "4-q": (111, 67, 46, 28),
  "4-h": (82, 50, 34, 21),
  "5-l": (255, 154, 106, 65),
  "5-m": (202, 122, 84, 52),
  "5-q": (144, 87, 60, 37),
  "5-h": (106, 64, 44, 27),
  "6-l": (322, 195, 134, 82),
  "6-m": (255, 154, 106, 65),
  "6-q": (178, 108, 74, 45),
  "6-h": (139, 84, 58, 36),
  "7-l": (370, 224, 154, 95),
  "7-m": (293, 178, 122, 75),
  "7-q": (207, 125, 86, 53),
  "7-h": (154, 93, 64, 39),
  "8-l": (461, 279, 192, 118),
  "8-m": (365, 221, 152, 93),
  "8-q": (259, 157, 108, 66),
  "8-h": (202, 122, 84, 52),
  "9-l": (552, 335, 230, 141),
  "9-m": (432, 262, 180, 111),
  "9-q": (312, 189, 130, 80),
  "9-h": (235, 143, 98, 60),
  "10-l": (652, 395, 271, 167),
  "10-m": (513, 311, 213, 131),
  "10-q": (364, 221, 151, 93),
  "10-h": (288, 174, 119, 74),
  "11-l": (772, 468, 321, 198),
  "11-m": (604, 366, 251, 155),
  "11-q": (427, 259, 177, 109),
  "11-h": (331, 200, 137, 85),
  "12-l": (883, 535, 367, 226),
  "12-m": (691, 419, 287, 177),
  "12-q": (489, 296, 203, 125),
  "12-h": (374, 227, 155, 96),
  "13-l": (1022, 619, 425, 262),
  "13-m": (796, 483, 331, 204),
  "13-q": (580, 352, 241, 149),
  "13-h": (427, 259, 177, 109),
  "14-l": (1101, 667, 458, 282),
  "14-m": (871, 528, 362, 223),
  "14-q": (621, 376, 258, 159),
  "14-h": (468, 283, 194, 120),
  "15-l": (1250, 758, 520, 320),
  "15-m": (991, 600, 412, 254),
  "15-q": (703, 426, 292, 180),
  "15-h": (530, 321, 220, 136),
  "16-l": (1408, 854, 586, 361),
  "16-m": (1082, 656, 450, 277),
  "16-q": (775, 470, 322, 198),
  "16-h": (602, 365, 250, 154),
  "17-l": (1548, 938, 644, 397),
  "17-m": (1212, 734, 504, 310),
  "17-q": (876, 531, 364, 224),
  "17-h": (674, 408, 280, 173),
  "18-l": (1725, 1046, 718, 442),
  "18-m": (1346, 816, 560, 345),
  "18-q": (948, 574, 394, 243),
  "18-h": (746, 452, 310, 191),
  "19-l": (1903, 1153, 792, 488),
  "19-m": (1500, 909, 624, 384),
  "19-q": (1063, 644, 442, 272),
  "19-h": (813, 493, 338, 208),
  "20-l": (2061, 1249, 858, 528),
  "20-m": (1600, 970, 666, 410),
  "20-q": (1159, 702, 482, 297),
  "20-h": (919, 557, 382, 235),
  "21-l": (2232, 1352, 929, 572),
  "21-m": (1708, 1035, 711, 438),
  "21-q": (1224, 742, 509, 314),
  "21-h": (969, 587, 403, 248),
  "22-l": (2409, 1460, 1003, 618),
  "22-m": (1872, 1134, 779, 480),
  "22-q": (1358, 823, 565, 348),
  "22-h": (1056, 640, 439, 270),
  "23-l": (2620, 1588, 1091, 672),
  "23-m": (2059, 1248, 857, 528),
  "23-q": (1468, 890, 611, 376),
  "23-h": (1108, 672, 461, 284),
  "24-l": (2812, 1704, 1171, 721),
  "24-m": (2188, 1326, 911, 561),
  "24-q": (1588, 963, 661, 407),
  "24-h": (1228, 744, 511, 315),
  "25-l": (3057, 1853, 1273, 784),
  "25-m": (2395, 1451, 997, 614),
  "25-q": (1718, 1041, 715, 440),
  "25-h": (1286, 779, 535, 330),
  "26-l": (3283, 1990, 1367, 842),
  "26-m": (2544, 1542, 1059, 652),
  "26-q": (1804, 1094, 751, 462),
  "26-h": (1425, 864, 593, 365),
  "27-l": (3517, 2132, 1465, 902),
  "27-m": (2701, 1637, 1125, 692),
  "27-q": (1933, 1172, 805, 496),
  "27-h": (1501, 910, 625, 385),
  "28-l": (3669, 2223, 1528, 940),
  "28-m": (2857, 1732, 1190, 732),
  "28-q": (2085, 1263, 868, 534),
  "28-h": (1581, 958, 658, 405),
  "29-l": (3909, 2369, 1628, 1002),
  "29-m": (3035, 1839, 1264, 778),
  "29-q": (2181, 1322, 908, 559),
  "29-h": (1677, 1016, 698, 430),
  "30-l": (4158, 2520, 1732, 1066),
  "30-m": (3289, 1994, 1370, 843),
  "30-q": (2358, 1429, 982, 604),
  "30-h": (1782, 1080, 742, 457),
  "31-l": (4417, 2677, 1840, 1132),
  "31-m": (3486, 2113, 1452, 894),
  "31-q": (2473, 1499, 1030, 634),
  "31-h": (1897, 1150, 790, 486),
  "32-l": (4686, 2840, 1952, 1201),
  "32-m": (3693, 2238, 1538, 947),
  "32-q": (2670, 1618, 1112, 684),
  "32-h": (2022, 1226, 842, 518),
  "33-l": (4965, 3009, 2068, 1273),
  "33-m": (3909, 2369, 1628, 1002),
  "33-q": (2805, 1700, 1168, 719),
  "33-h": (2157, 1307, 898, 553),
  "34-l": (5253, 3183, 2188, 1347),
  "34-m": (4134, 2506, 1722, 1060),
  "34-q": (2949, 1787, 1228, 756),
  "34-h": (2301, 1394, 958, 590),
  "35-l": (5529, 3351, 2303, 1417),
  "35-m": (4343, 2632, 1809, 1113),
  "35-q": (3081, 1867, 1283, 790),
  "35-h": (2361, 1431, 983, 605),
  "36-l": (5836, 3537, 2431, 1496),
  "36-m": (4588, 2780, 1911, 1176),
  "36-q": (3244, 1966, 1351, 832),
  "36-h": (2524, 1530, 1051, 647),
  "37-l": (6153, 3729, 2563, 1577),
  "37-m": (4775, 2894, 1989, 1224),
  "37-q": (3417, 2071, 1423, 876),
  "37-h": (2625, 1591, 1093, 673),
  "38-l": (6479, 3927, 2699, 1661),
  "38-m": (5039, 3054, 2099, 1292),
  "38-q": (3599, 2181, 1499, 923),
  "38-h": (2735, 1658, 1139, 701),
  "39-l": (6743, 4087, 2809, 1729),
  "39-m": (5313, 3220, 2213, 1362),
  "39-q": (3791, 2298, 1579, 972),
  "39-h": (2927, 1774, 1219, 750),
  "40-l": (7089, 4296, 2953, 1817),
  "40-m": (5596, 3391, 2331, 1435),
  "40-q": (3993, 2420, 1663, 1024),
  "40-h": (3057, 1852, 1273, 784)
)

#let blocks = (
  ( l: (7, 1),   m: (10, 1),  q: (13, 1),  h: (17, 1) ),
  ( l: (10, 1),  m: (16, 1),  q: (22, 1),  h: (28, 1) ),
  ( l: (15, 1),  m: (26, 1),  q: (18, 2),  h: (22, 2) ),
  ( l: (20, 1),  m: (18, 2),  q: (26, 2),  h: (16, 4) ),
  ( l: (26, 1),  m: (24, 2),  q: (18, 4),  h: (22, 4) ),
  ( l: (18, 2),  m: (16, 4),  q: (24, 4),  h: (28, 4) ),
  ( l: (20, 2),  m: (18, 4),  q: (18, 6),  h: (26, 5) ),
  ( l: (24, 2),  m: (22, 4),  q: (22, 6),  h: (26, 6) ),
  ( l: (30, 2),  m: (22, 5),  q: (20, 8),  h: (24, 8) ),
  ( l: (18, 4),  m: (26, 5),  q: (24, 8),  h: (28, 8) ),
  ( l: (20, 4),  m: (30, 5),  q: (28, 8),  h: (24, 11) ),
  ( l: (24, 4),  m: (22, 8),  q: (26, 10), h: (28, 11) ),
  ( l: (26, 4),  m: (22, 9),  q: (24, 12), h: (22, 16) ),
  ( l: (30, 4),  m: (24, 9),  q: (20, 16), h: (24, 16) ),
  ( l: (22, 6),  m: (24, 10), q: (30, 12), h: (24, 18) ),
  ( l: (24, 6),  m: (28, 10), q: (24, 17), h: (30, 16) ),
  ( l: (28, 6),  m: (28, 11), q: (28, 16), h: (28, 19) ),
  ( l: (30, 6),  m: (26, 13), q: (28, 18), h: (28, 21) ),
  ( l: (28, 7),  m: (26, 14), q: (26, 21), h: (26, 25) ),
  ( l: (28, 8),  m: (26, 16), q: (30, 20), h: (28, 25) ),
  ( l: (28, 8),  m: (26, 17), q: (28, 23), h: (30, 25) ),
  ( l: (28, 9),  m: (28, 17), q: (30, 23), h: (24, 34) ),
  ( l: (30, 9),  m: (28, 18), q: (30, 25), h: (30, 30) ),
  ( l: (30, 10), m: (28, 20), q: (30, 27), h: (30, 32) ),
  ( l: (26, 12), m: (28, 21), q: (30, 29), h: (30, 35) ),
  ( l: (28, 12), m: (28, 23), q: (28, 34), h: (30, 37) ),
  ( l: (30, 12), m: (28, 25), q: (30, 34), h: (30, 40) ),
  ( l: (30, 13), m: (28, 26), q: (30, 35), h: (30, 42) ),
  ( l: (30, 14), m: (28, 28), q: (30, 38), h: (30, 45) ),
  ( l: (30, 15), m: (28, 29), q: (30, 40), h: (30, 48) ),
  ( l: (30, 16), m: (28, 31), q: (30, 43), h: (30, 51) ),
  ( l: (30, 17), m: (28, 33), q: (30, 45), h: (30, 54) ),
  ( l: (30, 18), m: (28, 35), q: (30, 48), h: (30, 57) ),
  ( l: (30, 19), m: (28, 37), q: (30, 51), h: (30, 60) ),
  ( l: (30, 19), m: (28, 38), q: (30, 53), h: (30, 63) ),
  ( l: (30, 20), m: (28, 40), q: (30, 56), h: (30, 66) ),
  ( l: (30, 21), m: (28, 43), q: (30, 59), h: (30, 70) ),
  ( l: (30, 22), m: (28, 45), q: (30, 62), h: (30, 74) ),
  ( l: (30, 24), m: (28, 47), q: (30, 65), h: (30, 77) ),
  ( l: (30, 25), m: (28, 49), q: (30, 68), h: (30, 81) )
)

#let alignments = (
    (), (6,18), (6, 22), (6, 26), (6, 30), (6, 34),
    (6, 22, 38), (6, 24, 42), (6, 26, 46),
    (6, 28, 50), (6, 30, 54), (6, 32, 58),
    (6, 34, 62), (6, 26, 46, 66), (6, 26, 48, 70),
    (6, 26, 50, 74), (6, 30, 54, 78), (6, 30, 56, 82),
    (6, 30, 58, 86), (6, 34, 62, 90), (6, 28, 50, 72, 94),
    (6, 26, 50, 74, 98), (6, 30, 54, 78, 102), (6, 28, 54, 80, 106),
    (6, 32, 58, 84, 110), (6, 30, 58, 86, 114),
    (6, 34, 62, 90, 118), (6, 26, 50, 74, 98, 122),
    (6, 30, 54, 78, 102, 126), (6, 26, 52, 78, 104, 130),
    (6, 30, 56, 82, 108, 134), (6, 34, 60, 86, 112, 138),
    (6, 30, 58, 86, 114, 142), (6, 34, 62, 90, 118, 146),
    (6, 30, 54, 78, 102, 126, 150),
    (6, 24, 50, 76, 102, 128, 154),
    (6, 28, 54, 80, 106, 132, 158),
    (6, 32, 58, 84, 110, 136, 162),
    (6, 26, 54, 82, 110, 138, 166),
    (6, 30, 58, 86, 114, 142, 170)
  )

#let version-formats = (
  "000111110010010100",
  "001000010110111100",
  "001001101010011001",
  "001010010011010011",
  "001011101111110110",
  "001100011101100010",
  "001101100001000111",
  "001110011000001101",
  "001111100100101000",
  "010000101101111000",
  "010001010001011101",
  "010010101000010111",
  "010011010100110010",
  "010100100110100110",
  "010101011010000011",
  "010110100011001001",
  "010111011111101100",
  "011000111011000100",
  "011001000111100001",
  "011010111110101011",
  "011011000010001110",
  "011100110000011010",
  "011101001100111111",
  "011110110101110101",
  "011111001001010000",
  "100000100111010101",
  "100001011011110000",
  "100010100010111010",
  "100011011110011111",
  "100100101100001011",
  "100101010000101110",
  "100110101001100100",
  "100111010101000001",
  "101000110001101001"
)

#let format-information = (
  l: (
    "111011111000100",
    "111001011110011",
    "111110110101010",
    "111100010011101",
    "110011000101111",
    "110001100011000",
    "110110001000001",
    "110100101110110"
  ),
  m: (
    "101010000010010",
    "101000100100101",
    "101111001111100",
    "101101101001011",
    "100010111111001",
    "100000011001110",
    "100111110010111",
    "100101010100000"
  ),
  q: (
    "011010101011111",
    "011000001101000",
    "011111100110001",
    "011101000000110",
    "010010010110100",
    "010000110000011",
    "010111011011010",
    "010101111101101"
  ),
  h: (
    "001011010001001",
    "001001110111110",
    "001110011100111",
    "001100111010000",
    "000011101100010",
    "000001001010101",
    "000110100001100",
    "000100000111011"
  )
)

#let exp = (1,
  2, 4, 8, 16, 32, 64, 128, 29, 58, 116, 232, 205, 135, 19, 38, 76, 152, 45, 90, 180, 117, 234, 201, 143, 3, 6, 12, 24, 48, 96, 192, 157, 39, 78, 156, 37, 74, 148, 53, 106, 212, 181, 119, 238, 193, 159, 35, 70, 140, 5, 10, 20, 40, 80, 160, 93, 186, 105, 210, 185, 111, 222, 161, 95, 190, 97, 194, 153, 47, 94, 188, 101, 202, 137, 15, 30, 60, 120, 240, 253, 231, 211, 187, 107, 214, 177, 127, 254, 225, 223, 163, 91, 182, 113, 226, 217, 175, 67, 134, 17, 34, 68, 136, 13, 26, 52, 104, 208, 189, 103, 206, 129, 31, 62, 124, 248, 237, 199, 147, 59, 118, 236, 197, 151, 51, 102, 204, 133, 23, 46, 92, 184, 109, 218, 169, 79, 158, 33, 66, 132, 21, 42, 84, 168, 77, 154, 41, 82, 164, 85, 170, 73, 146, 57, 114, 228, 213, 183, 115, 230, 209, 191, 99, 198, 145, 63, 126, 252, 229, 215, 179, 123, 246, 241, 255, 227, 219, 171, 75, 150, 49, 98, 196, 149, 55, 110, 220, 165, 87, 174, 65, 130, 25, 50, 100, 200, 141, 7, 14, 28, 56, 112, 224, 221, 167, 83, 166, 81, 162, 89, 178, 121, 242, 249, 239, 195, 155, 43, 86, 172, 69, 138, 9, 18, 36, 72, 144, 61, 122, 244, 245, 247, 243, 251, 235, 203, 139, 11, 22, 44, 88, 176, 125, 250, 233, 207, 131, 27, 54, 108, 216, 173, 71, 142, 1
)

#let log = (
  0, // padding
  0, 1, 25, 2, 50, 26, 198, 3, 223, 51, 238, 27, 104, 199, 75, 4, 100, 224, 14, 52, 141, 239, 129, 28, 193, 105, 248, 200, 8, 76, 113, 5, 138, 101, 47, 225, 36, 15, 33, 53, 147, 142, 218, 240, 18, 130, 69, 29, 181, 194, 125, 106, 39, 249, 185, 201, 154, 9, 120, 77, 228, 114, 166, 6, 191, 139, 98, 102, 221, 48, 253, 226, 152, 37, 179, 16, 145, 34, 136, 54, 208, 148, 206, 143, 150, 219, 189, 241, 210, 19, 92, 131, 56, 70, 64, 30, 66, 182, 163, 195, 72, 126, 110, 107, 58, 40, 84, 250, 133, 186, 61, 202, 94, 155, 159, 10, 21, 121, 43, 78, 212, 229, 172, 115, 243, 167, 87, 7, 112, 192, 247, 140, 128, 99, 13, 103, 74, 222, 237, 49, 197, 254, 24, 227, 165, 153, 119, 38, 184, 180, 124, 17, 68, 146, 217, 35, 32, 137, 46, 55, 63, 209, 91, 149, 188, 207, 205, 144, 135, 151, 178, 220, 252, 190, 97, 242, 86, 211, 171, 20, 42, 93, 158, 132, 60, 57, 83, 71, 109, 65, 162, 31, 45, 67, 216, 183, 123, 164, 118, 196, 23, 73, 236, 127, 12, 111, 246, 108, 161, 59, 82, 41, 157, 85, 170, 251, 96, 134, 177, 187, 204, 62, 90, 203, 89, 95, 176, 156, 169, 160, 81, 11, 245, 22, 235, 122, 117, 44, 215, 79, 174, 213, 233, 230, 231, 173, 232, 116, 214, 244, 234, 168, 80, 88, 175
)

#let generators = (
  (1, 127, 122, 154, 164, 11, 68, 117), (1, 255, 11, 81, 54, 239, 173, 200, 24), (1, 226, 207, 158, 245, 235, 164, 232, 197, 37), (1, 216, 194, 159, 111, 199, 94, 95, 113, 157, 193), (1, 172, 130, 163, 50, 123, 219, 162, 248, 144, 116, 160), (1, 68, 119, 67, 118, 220, 31, 7, 84, 92, 127, 213, 97), (1, 137, 73, 227, 17, 177, 17, 52, 13, 46, 43, 83, 132, 120), (1, 14, 54, 114, 70, 174, 151, 43, 158, 195, 127, 166, 210, 234, 163), (1, 29, 196, 111, 163, 112, 74, 10, 105, 105, 139, 132, 151, 32, 134, 26), (1, 59, 13, 104, 189, 68, 209, 30, 8, 163, 65, 41, 229, 98, 50, 36, 59), (1, 119, 66, 83, 120, 119, 22, 197, 83, 249, 41, 143, 134, 85, 53, 125, 99, 79), (1, 239, 251, 183, 113, 149, 175, 199, 215, 240, 220, 73, 82, 173, 75, 32, 67, 217, 146), (1, 194, 8, 26, 146, 20, 223, 187, 152, 85, 115, 238, 133, 146, 109, 173, 138, 33, 172, 179), (1, 152, 185, 240, 5, 111, 99, 6, 220, 112, 150, 69, 36, 187, 22, 228, 198, 121, 121, 165, 174), (1, 44, 243, 13, 131, 49, 132, 194, 67, 214, 28, 89, 124, 82, 158, 244, 37, 236, 142, 82, 255, 89), (1, 89, 179, 131, 176, 182, 244, 19, 189, 69, 40, 28, 137, 29, 123, 67, 253, 86, 218, 230, 26, 145, 245), (1, 179, 68, 154, 163, 140, 136, 190, 152, 25, 85, 19, 3, 196, 27, 113, 198, 18, 130, 2, 120, 93, 41, 71), (1, 122, 118, 169, 70, 178, 237, 216, 102, 115, 150, 229, 73, 130, 72, 61, 43, 206, 1, 237, 247, 127, 217, 144, 117), (1, 245, 49, 228, 53, 215, 6, 205, 210, 38, 82, 56, 80, 97, 139, 81, 134, 126, 168, 98, 226, 125, 23, 171, 173, 193), (1, 246, 51, 183, 4, 136, 98, 199, 152, 77, 56, 206, 24, 145, 40, 209, 117, 233, 42, 135, 68, 70, 144, 146, 77, 43, 94), (1, 240, 61, 29, 145, 144, 117, 150, 48, 58, 139, 94, 134, 193, 105, 33, 169, 202, 102, 123, 113, 195, 25, 213, 6, 152, 164, 217), (1, 252, 9, 28, 13, 18, 251, 208, 150, 103, 174, 100, 41, 167, 12, 247, 56, 117, 119, 233, 127, 181, 100, 121, 147, 176, 74, 58, 197), (1, 228, 193, 196, 48, 170, 86, 80, 217, 54, 143, 79, 32, 88, 255, 87, 24, 15, 251, 85, 82, 201, 58, 112, 191, 153, 108, 132, 143, 170), (1, 212, 246, 77, 73, 195, 192, 75, 98, 5, 70, 103, 177, 22, 217, 138, 51, 181, 246, 72, 25, 18, 46, 228, 74, 216, 195, 11, 106, 130, 150)
)
